#!/bin/bash

. /root/kernel.data

### DPDK
# need libpcap and libnuma development environments

# this includes Ubuntu
if [[ -e /etc/debian_version ]]; then
	apt-get install -y libnuma-dev libpcap-dev
	apt-get install -y openvswitch-switch-dpdk openvswitch-test dpdk-dev  \
	       dpdk-igb-uio-dkms dpdk-rte-kni-dkms python-networking-ovs-dpdk \
	       openvswitch-vtep openvswitch-pki openvswitch-testcontroller    \
	       librte-pmd-mlx5-17.11 librte-pmd-mlx4-17.11                    \
	       librte-pmd-virtio17.11 librte-pmd-vhost17.11                   \
	       librte-pmd-i40e17.11 librte-pmd-cxgbe17.11                     \
	       librte-pmd-bond17.11 librte-pmd-af-packet17.11                 \
	       librte-pmd-ixgbe17.11 librte-pmd-pcap17.11 		      \
	       librte-pmd-virtio17.11 librte-pmd-vhost17.11                   \
	       librte-pmd-tap17.11 librte-pmd-lio17.11 librte-pmd-i40e17.11   \
	       librte-mempool-ring17.11 librte-latencystats17.11              \
	       librte-flow-classify17.11 librte-bus-pci17.11 libdpdk-dev      

fi

if [[ -e /etc/redhat-release ]]; then
        yum -y install numactl-devel libpcap-devel numactl libpcap
	DPDK_BUILD_OPTS="RTE_KERNELDIR=/usr/src/kernels/${KERNEL_VERSION} CONFIG_RTE_LIBRTE_MLX5_PMD=y"
fi
